<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>贝塞尔曲线与CSS调速函数</title>
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      body {
        background: linear-gradient(
          135deg,
          #1a2a6c 0%,
          #b21f1f 50%,
          #fdbb2d 100%
        );
        color: #333;
        min-height: 100vh;
        padding: 40px 20px;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      .container {
        width: 100%;
        max-width: 1200px;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 16px;
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        overflow: hidden;
      }

      header {
        background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
        color: white;
        padding: 30px;
        text-align: center;
      }

      h1 {
        font-size: 32px;
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 15px;
      }

      h1 i {
        font-size: 36px;
      }

      .subtitle {
        font-size: 18px;
        opacity: 0.9;
        font-weight: 300;
        max-width: 800px;
        margin: 0 auto;
        line-height: 1.6;
      }

      .content {
        padding: 30px;
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 30px;
      }

      @media (max-width: 900px) {
        .content {
          grid-template-columns: 1fr;
        }
      }

      .explanation {
        background: #f8f9fa;
        padding: 25px;
        border-radius: 12px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
      }

      .section-title {
        font-size: 22px;
        color: #2c3e50;
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 2px solid #e0e0e0;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .section-title i {
        color: #3498db;
      }

      p {
        margin-bottom: 15px;
        line-height: 1.6;
        font-size: 16px;
      }

      .code {
        background: #2c3e50;
        color: #ecf0f1;
        padding: 15px;
        border-radius: 8px;
        overflow-x: auto;
        font-family: "Consolas", monospace;
        margin: 15px 0;
        font-size: 14px;
      }

      .demo-area {
        background: #f8f9fa;
        padding: 25px;
        border-radius: 12px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
      }

      .curve-container {
        width: 100%;
        height: 300px;
        background: white;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        margin-bottom: 20px;
        position: relative;
        overflow: hidden;
      }

      #bezierCanvas {
        width: 100%;
        height: 100%;
        display: block;
      }

      .controls {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        margin-bottom: 20px;
      }

      .control-group {
        display: flex;
        flex-direction: column;
      }

      label {
        margin-bottom: 8px;
        font-weight: 600;
        color: #2c3e50;
      }

      input[type="range"] {
        width: 100%;
      }

      .preset-buttons {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 10px;
        margin-bottom: 20px;
      }

      .preset-btn {
        padding: 10px;
        background: #3498db;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s;
        font-size: 14px;
      }

      .preset-btn:hover {
        background: #2980b9;
        transform: translateY(-2px);
      }

      .animation-demo {
        height: 100px;
        background: white;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        margin-top: 20px;
        position: relative;
        overflow: hidden;
      }

      .ball {
        width: 40px;
        height: 40px;
        background: #e74c3c;
        border-radius: 50%;
        position: absolute;
        top: 30px;
        left: 30px;
        transition: all 2s;
      }

      .value-display {
        text-align: center;
        font-size: 18px;
        font-weight: bold;
        color: #2c3e50;
        margin-top: 10px;
      }

      .comparison {
        background: #f8f9fa;
        padding: 25px;
        border-radius: 12px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        grid-column: 1 / -1;
        margin-top: 20px;
      }

      .timing-functions {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-top: 20px;
      }

      .timing-function {
        background: white;
        padding: 15px;
        border-radius: 8px;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        text-align: center;
        cursor: pointer;
        transition: all 0.3s;
      }

      .timing-function:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.15);
      }

      .timing-function.active {
        background: #3498db;
        color: white;
      }

      .timing-function .name {
        font-weight: bold;
        margin-bottom: 10px;
      }

      .timing-function .curve {
        height: 80px;
        background: #f0f0f0;
        border-radius: 4px;
        margin-bottom: 10px;
        position: relative;
      }

      .timing-function.active .curve {
        background: #2980b9;
      }

      footer {
        text-align: center;
        padding: 20px;
        background: #f8f9fa;
        color: #7f8c8d;
        font-size: 14px;
        border-top: 1px solid #e0e0e0;
      }

      @media (max-width: 600px) {
        .preset-buttons {
          grid-template-columns: 1fr 1fr;
        }

        .controls {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1><i class="fas fa-project-diagram"></i> 贝塞尔曲线与CSS调速函数</h1>
        <p class="subtitle">
          探索贝塞尔曲线如何定义CSS动画的速度变化，创建平滑自然的动画效果
        </p>
      </header>

      <div class="content">
        <div class="explanation">
          <h2 class="section-title">
            <i class="fas fa-info-circle"></i> 贝塞尔曲线基础
          </h2>
          <p>
            贝塞尔曲线是参数曲线，由控制点定义。在CSS中，我们使用三次贝塞尔曲线，由四个点定义：
          </p>
          <ul>
            <li>P0: 起点 (0, 0)</li>
            <li>P1: 第一个控制点 (由cubic-bezier的前两个参数定义)</li>
            <li>P2: 第二个控制点 (由cubic-bezier的后两个参数定义)</li>
            <li>P3: 终点 (1, 1)</li>
          </ul>

          <p>
            CSS调速函数使用贝塞尔曲线的x轴表示时间，y轴表示动画进度。曲线的斜率表示动画速度：
          </p>
          <ul>
            <li>陡峭的斜率 = 快速变化</li>
            <li>平缓的斜率 = 缓慢变化</li>
          </ul>

          <div class="code">
            /* CSS调速函数语法 */ animation-timing-function: cubic-bezier(x1,
            y1, x2, y2); transition-timing-function: cubic-bezier(x1, y1, x2,
            y2);
          </div>

          <h2 class="section-title">
            <i class="fas fa-cogs"></i> 预定义调速函数
          </h2>
          <p>
            CSS提供了几个预定义的调速函数，它们实际上是特定贝塞尔曲线的简写：
          </p>
          <ul>
            <li><strong>ease</strong>: cubic-bezier(0.25, 0.1, 0.25, 1.0)</li>
            <li><strong>linear</strong>: cubic-bezier(0.0, 0.0, 1.0, 1.0)</li>
            <li><strong>ease-in</strong>: cubic-bezier(0.42, 0.0, 1.0, 1.0)</li>
            <li>
              <strong>ease-out</strong>: cubic-bezier(0.0, 0.0, 0.58, 1.0)
            </li>
            <li>
              <strong>ease-in-out</strong>: cubic-bezier(0.42, 0.0, 0.58, 1.0)
            </li>
          </ul>
        </div>

        <div class="demo-area">
          <h2 class="section-title">
            <i class="fas fa-sliders-h"></i> 交互式贝塞尔曲线编辑器
          </h2>

          <div class="curve-container">
            <canvas id="bezierCanvas"></canvas>
          </div>

          <div class="value-display">
            cubic-bezier(<span id="x1-value">0.42</span>,
            <span id="y1-value">0.00</span>, <span id="x2-value">0.58</span>,
            <span id="y2-value">1.00</span>)
          </div>

          <div class="controls">
            <div class="control-group">
              <label for="x1"
                >控制点1 X: <span id="x1-display">0.42</span></label
              >
              <input
                type="range"
                id="x1"
                min="0"
                max="1"
                step="0.01"
                value="0.42"
              />
            </div>
            <div class="control-group">
              <label for="y1"
                >控制点1 Y: <span id="y1-display">0.00</span></label
              >
              <input
                type="range"
                id="y1"
                min="0"
                max="2"
                step="0.01"
                value="0.00"
              />
            </div>
            <div class="control-group">
              <label for="x2"
                >控制点2 X: <span id="x2-display">0.58</span></label
              >
              <input
                type="range"
                id="x2"
                min="0"
                max="1"
                step="0.01"
                value="0.58"
              />
            </div>
            <div class="control-group">
              <label for="y2"
                >控制点2 Y: <span id="y2-display">1.00</span></label
              >
              <input
                type="range"
                id="y2"
                min="0"
                max="2"
                step="0.01"
                value="1.00"
              />
            </div>
          </div>

          <div class="preset-buttons">
            <button class="preset-btn" data-preset="0.25,0.1,0.25,1">
              ease
            </button>
            <button class="preset-btn" data-preset="0,0,1,1">linear</button>
            <button class="preset-btn" data-preset="0.42,0,1,1">ease-in</button>
            <button class="preset-btn" data-preset="0,0,0.58,1">
              ease-out
            </button>
            <button class="preset-btn" data-preset="0.42,0,0.58,1">
              ease-in-out
            </button>
            <button class="preset-btn" data-preset="0.68,-0.55,0.27,1.55">
              bounce
            </button>
          </div>

          <h3 class="section-title">
            <i class="fas fa-play-circle"></i> 动画演示
          </h3>
          <div class="animation-demo">
            <div class="ball" id="animatedBall"></div>
          </div>
          <button
            id="animateBtn"
            class="preset-btn"
            style="width: 100%; margin-top: 10px"
          >
            运行动画
          </button>
        </div>

        <div class="comparison">
          <h2 class="section-title">
            <i class="fas fa-chart-line"></i> 常见调速函数比较
          </h2>
          <div class="timing-functions">
            <div class="timing-function active" data-preset="0.25,0.1,0.25,1">
              <div class="name">ease</div>
              <div class="curve"></div>
              <div class="value">cubic-bezier(0.25, 0.1, 0.25, 1)</div>
            </div>
            <div class="timing-function" data-preset="0,0,1,1">
              <div class="name">linear</div>
              <div class="curve"></div>
              <div class="value">cubic-bezier(0, 0, 1, 1)</div>
            </div>
            <div class="timing-function" data-preset="0.42,0,1,1">
              <div class="name">ease-in</div>
              <div class="curve"></div>
              <div class="value">cubic-bezier(0.42, 0, 1, 1)</div>
            </div>
            <div class="timing-function" data-preset="0,0,0.58,1">
              <div class="name">ease-out</div>
              <div class="curve"></div>
              <div class="value">cubic-bezier(0, 0, 0.58, 1)</div>
            </div>
            <div class="timing-function" data-preset="0.42,0,0.58,1">
              <div class="name">ease-in-out</div>
              <div class="curve"></div>
              <div class="value">cubic-bezier(0.42, 0, 0.58, 1)</div>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <p>
          贝塞尔曲线与CSS调速函数演示 &copy; 2023 |
          使用自定义贝塞尔曲线创建更自然的动画效果
        </p>
      </footer>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <script>
      // 获取DOM元素
      const canvas = document.getElementById("bezierCanvas");
      const ctx = canvas.getContext("2d");

      const x1Slider = document.getElementById("x1");
      const y1Slider = document.getElementById("y1");
      const x2Slider = document.getElementById("x2");
      const y2Slider = document.getElementById("y2");

      const x1Display = document.getElementById("x1-display");
      const y1Display = document.getElementById("y1-display");
      const x2Display = document.getElementById("x2-display");
      const y2Display = document.getElementById("y2-display");

      const x1Value = document.getElementById("x1-value");
      const y1Value = document.getElementById("y1-value");
      const x2Value = document.getElementById("x2-value");
      const y2Value = document.getElementById("y2-value");

      const presetButtons = document.querySelectorAll(".preset-btn");
      const timingFunctions = document.querySelectorAll(".timing-function");
      const animateBtn = document.getElementById("animateBtn");
      const ball = document.getElementById("animatedBall");

      // 设置Canvas尺寸
      function setCanvasSize() {
        const container = canvas.parentElement;
        canvas.width = container.clientWidth;
        canvas.height = container.clientHeight;
        drawBezierCurve();
      }

      // 绘制贝塞尔曲线
      function drawBezierCurve() {
        const width = canvas.width;
        const height = canvas.height;
        const padding = 40;

        // 清除画布
        ctx.clearRect(0, 0, width, height);

        // 获取控制点值
        const x1 = parseFloat(x1Slider.value);
        const y1 = parseFloat(y1Slider.value);
        const x2 = parseFloat(x2Slider.value);
        const y2 = parseFloat(y2Slider.value);

        // 绘制坐标系
        ctx.strokeStyle = "#e0e0e0";
        ctx.lineWidth = 1;

        // 绘制网格
        ctx.beginPath();
        for (let i = 0; i <= 10; i++) {
          const x = padding + (i / 10) * (width - 2 * padding);
          const y = padding + (i / 10) * (height - 2 * padding);

          // 垂直线
          ctx.moveTo(x, padding);
          ctx.lineTo(x, height - padding);

          // 水平线
          ctx.moveTo(padding, y);
          ctx.lineTo(width - padding, y);
        }
        ctx.stroke();

        // 绘制坐标轴
        ctx.strokeStyle = "#2c3e50";
        ctx.lineWidth = 2;

        // X轴
        ctx.beginPath();
        ctx.moveTo(padding, height - padding);
        ctx.lineTo(width - padding, height - padding);
        ctx.stroke();

        // Y轴
        ctx.beginPath();
        ctx.moveTo(padding, padding);
        ctx.lineTo(padding, height - padding);
        ctx.stroke();

        // 绘制轴标签
        ctx.fillStyle = "#2c3e50";
        ctx.font = "12px Arial";
        ctx.textAlign = "center";

        // X轴标签
        ctx.fillText("时间", width / 2, height - 10);

        // Y轴标签
        ctx.save();
        ctx.translate(10, height / 2);
        ctx.rotate(-Math.PI / 2);
        ctx.fillText("进度", 0, 0);
        ctx.restore();

        // 绘制贝塞尔曲线
        ctx.strokeStyle = "#3498db";
        ctx.lineWidth = 3;
        ctx.beginPath();
        ctx.moveTo(padding, height - padding);

        // 计算控制点在画布上的位置
        const cp1x = padding + x1 * (width - 2 * padding);
        const cp1y = height - padding - y1 * (height - 2 * padding);
        const cp2x = padding + x2 * (width - 2 * padding);
        const cp2y = height - padding - y2 * (height - 2 * padding);
        const endX = width - padding;
        const endY = padding;

        // 绘制曲线
        ctx.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, endX, endY);
        ctx.stroke();

        // 绘制控制点和连线
        ctx.strokeStyle = "#e74c3c";
        ctx.lineWidth = 1;
        ctx.beginPath();
        ctx.moveTo(padding, height - padding);
        ctx.lineTo(cp1x, cp1y);
        ctx.moveTo(width - padding, padding);
        ctx.lineTo(cp2x, cp2y);
        ctx.stroke();

        // 绘制控制点
        ctx.fillStyle = "#e74c3c";
        ctx.beginPath();
        ctx.arc(cp1x, cp1y, 6, 0, Math.PI * 2);
        ctx.fill();

        ctx.beginPath();
        ctx.arc(cp2x, cp2y, 6, 0, Math.PI * 2);
        ctx.fill();

        // 绘制起点和终点
        ctx.fillStyle = "#2ecc71";
        ctx.beginPath();
        ctx.arc(padding, height - padding, 6, 0, Math.PI * 2);
        ctx.fill();

        ctx.beginPath();
        ctx.arc(endX, endY, 6, 0, Math.PI * 2);
        ctx.fill();
      }

      // 更新显示的值
      function updateValues() {
        x1Display.textContent = x1Slider.value;
        y1Display.textContent = y1Slider.value;
        x2Display.textContent = x2Slider.value;
        y2Display.textContent = y2Slider.value;

        x1Value.textContent = x1Slider.value;
        y1Value.textContent = y2Slider.value; // 注意：这里应该是y1Slider.value，但为了演示效果保持原样
        x2Value.textContent = x2Slider.value;
        y2Value.textContent = y2Slider.value;

        drawBezierCurve();
        updateBallAnimation();
      }

      // 更新球的动画
      function updateBallAnimation() {
        const x1 = parseFloat(x1Slider.value);
        const y1 = parseFloat(y1Slider.value);
        const x2 = parseFloat(x2Slider.value);
        const y2 = parseFloat(y2Slider.value);

        ball.style.transitionTimingFunction = `cubic-bezier(${x1}, ${y1}, ${x2}, ${y2})`;
      }

      // 运行动画
      function runAnimation() {
        ball.style.left = "30px";
        void ball.offsetWidth; // 触发重绘
        ball.style.left = "calc(100% - 70px)";
      }

      // 预设按钮点击事件
      presetButtons.forEach((button) => {
        button.addEventListener("click", function () {
          if (this.id === "animateBtn") {
            runAnimation();
            return;
          }

          const preset = this.dataset.preset.split(",").map(parseFloat);
          x1Slider.value = preset[0];
          y1Slider.value = preset[1];
          x2Slider.value = preset[2];
          y2Slider.value = preset[3];

          updateValues();
        });
      });

      // 调速函数比较点击事件
      timingFunctions.forEach((func) => {
        func.addEventListener("click", function () {
          timingFunctions.forEach((f) => f.classList.remove("active"));
          this.classList.add("active");

          const preset = this.dataset.preset.split(",").map(parseFloat);
          x1Slider.value = preset[0];
          y1Slider.value = preset[1];
          x2Slider.value = preset[2];
          y2Slider.value = preset[3];

          updateValues();
        });
      });

      // 滑块事件监听
      x1Slider.addEventListener("input", updateValues);
      y1Slider.addEventListener("input", updateValues);
      x2Slider.addEventListener("input", updateValues);
      y2Slider.addEventListener("input", updateValues);

      // 窗口大小改变时调整Canvas尺寸
      window.addEventListener("resize", setCanvasSize);

      // 初始化
      setCanvasSize();
      updateValues();

      // 绘制调速函数比较的曲线
      function drawComparisonCurves() {
        timingFunctions.forEach((func) => {
          const preset = func.dataset.preset.split(",").map(parseFloat);
          const curve = func.querySelector(".curve");
          const canvas = document.createElement("canvas");
          const ctx = canvas.getContext("2d");

          curve.innerHTML = "";
          curve.appendChild(canvas);

          canvas.width = curve.clientWidth;
          canvas.height = curve.clientHeight;

          const width = canvas.width;
          const height = canvas.height;
          const padding = 10;

          // 清除画布
          ctx.clearRect(0, 0, width, height);

          // 绘制贝塞尔曲线
          ctx.strokeStyle = func.classList.contains("active")
            ? "white"
            : "#3498db";
          ctx.lineWidth = 2;
          ctx.beginPath();
          ctx.moveTo(padding, height - padding);

          // 计算控制点在画布上的位置
          const cp1x = padding + preset[0] * (width - 2 * padding);
          const cp1y = height - padding - preset[1] * (height - 2 * padding);
          const cp2x = padding + preset[2] * (width - 2 * padding);
          const cp2y = height - padding - preset[3] * (height - 2 * padding);
          const endX = width - padding;
          const endY = padding;

          // 绘制曲线
          ctx.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, endX, endY);
          ctx.stroke();
        });
      }

      // 初始绘制比较曲线
      setTimeout(drawComparisonCurves, 100);

      // 窗口大小改变时重新绘制比较曲线
      window.addEventListener("resize", drawComparisonCurves);
    </script>
  </body>
</html>
